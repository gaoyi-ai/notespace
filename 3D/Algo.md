# PnP

PnP(Perspective-n-Point)是求解3D到2D点对运动的方法，目的是求解相机坐标系相对世界坐标系的位 姿。它描述了已知 $n$ 个3D点的坐标(相对世界坐标系)以及这些点的像素坐标时，如何估计相机的位姿(即 求解世界坐标系到相机坐标系的旋转矩阵 $R$ 和平移向量 $t$ 。

用数学公式描述如下:
基本公式: $\omega \boldsymbol{p}=K P^{C}=K\left(R_{C W} \times P^{W}+t_{C W}^{C}\right)$ ，$p$ 为点在像素坐标系下的坐标， $P^{C}$ 为点 在相机坐标系下的坐标， $P^{W}$ 为点在世界坐标系下的坐标， $\omega$ 为点的深度， $K$ 为相机的内参矩阵， $R_{C W}$ 和 $t_{C W}^{C}$ 为从世界坐标系到相机坐标系的位姿转换。

已知: $n$ 个点在世界坐标系下的坐标 $P_{1}^{W}, P_{2}^{W}, \ldots, P_{n}^{W}$ ，这些点相应在像素坐标系下的坐标 $\boldsymbol{p}_{1}, \boldsymbol{p}_{2}, \ldots, \boldsymbol{p}_{n}$, 相机内参矩阵 $K$ 。由于是已知 $n$ 个点的3D-2D对应关系，所以相应问题被称作PnP问 题。

求解: 相机坐标系相对于世界坐标系的位姿，即 $P^{C}=R_{C W} \times P^{W}+t_{C W}^{C}$ 中的 $R_{C W}$ 和 $t_{C W}^{C}$ 。 $R_{C W}$ 是世界坐标系到相机坐标系的旋转矩阵(将同一个向量在世界坐标系下的表示转化为在相机坐标系 下的表示)， $t_{C W}^{C}$ 为相应的平移向量(即从相机坐标系原点指向世界坐标系原点的向量，在相机坐标系下 的表示)。

算法：直接线性变换(DLT)、P3P、EPnP、光束法平差(BA，Bundle Adjustment)。
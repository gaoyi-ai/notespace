---
title: 如何通俗并尽可能详细地解释卡尔曼滤波
categories:
- Probabilistic Robotics
- State Estimation
- Kalman Filter
tags:
- Kalman filter
date: 2021/6/6 20:00:09
updated: 2021/6/6 12:00:09
---



> [如何通俗并尽可能详细地解释卡尔曼滤波](https://www.zhihu.com/question/23971601)

# 如何通俗并尽可能详细地解释卡尔曼滤波

假设你有两个传感器，测的是同一个信号。可是它们每次的读数都不太一样，怎么办？

**取平均。**

再假设你知道其中贵的那个传感器应该准一些，便宜的那个应该差一些。那有比取平均更好的办法吗？

**加权平均。**

怎么加权？假设两个传感器的误差都符合正态分布，假设你知道这两个正态分布的方差，用这两个方差值，（此处省略若干数学公式），你可以得到一个 “最优” 的权重。

接下来，重点来了：假设你只有一个传感器，但是你还有一个数学模型。模型可以帮你算出一个值，但也不是那么准。怎么办？

**把模型算出来的值，和传感器测出的值，（就像两个传感器那样），取加权平均。**

OK，最后一点说明：你的模型其实只是一个步长的，也就是说，知道 x(k)，我可以求 x(k+1)。问题是 x(k) 是多少呢？答案：x(k) 就是你上一步卡尔曼滤波得到的、所谓加权平均之后的那个、对 x 在 k 时刻的最佳估计值。

于是**迭代**也有了。

这就是卡尔曼滤波。

---

考虑轨道上的一个小车，无外力作用，它在时刻 t 的状态向量![](https://www.zhihu.com/equation?tex=x%28t%29)只与![](https://www.zhihu.com/equation?tex=x%28t-1%29)相关：
（状态向量就是描述它的 t=0 时刻所有状态的向量，比如：
[速度大小 5m/s, 速度方向右, 位置坐标 0]，反正有了这个向量就可以完全预测 t=1 时刻小车的状态)

![](https://www.zhihu.com/equation?tex=x%28t%29%3DFx%28t-1%29)

那么根据 t=0 时刻的初值![](https://www.zhihu.com/equation?tex=x%280%29)，理论上我们可以求出它任意时刻的状态。

当然，实际情况不会这么美好。

这个递推函数可能会**受到各种不确定因素的影响**（内在的外在的都算，比如刮风下雨地震，小车结构不紧密，轮子不圆等等）导致![](https://www.zhihu.com/equation?tex=x%28t%29)并不能精确标识小车实际的状态。

我们假设每个状态分量受到的不确定因素都服从正态分布。

**现在仅对小车的位置进行估计**

请看下图：t=0 时小车的位置服从红色的正态分布。

![](https://pic1.zhimg.com/50/23619dc1894b5a099b7351e267bf7efe_hd.jpg?source=1940ef5c)

根据小车的这个位置，我们可以预测出 t=1 时刻它的位置：

![](https://pic1.zhimg.com/50/003e9521ce6e69dfd8b7f601660795ad_hd.jpg?source=1940ef5c)

分布变 “胖” 了，这很好理解——因为在递推的过程中又加了一层噪声，所以不确定度变大了。

为了避免纯估计带来的偏差，我们在 t=1 时刻对小车的位置坐标进行一次雷达测量，当然雷达对小车距离的测量也会受到种种因素的影响，于是测量结果告诉我们，小车 t=1 时的位置服从蓝色分布：

![img](https://pic2.zhimg.com/3bd423de2871befd8cce80c49803e460_r.jpg?source=1940ef5c)

现在我们得到两个不同的结果。前面有人提过加权，Kalman 老先生的牛逼之处就在于找到了相应权值，使红蓝分布合并为下图这个**绿色的正态分布**（啰嗦一句，这个绿色分布均值位置在红蓝均值间的比例称为 Kalman 增益 (比如下图中近似 0.8)，就是各种公式里的 K(t)）

![](https://pic1.zhimg.com/50/83666ee825877a07256bc1c8b0386f45_hd.jpg?source=1940ef5c)

绿色分布不仅保证了在红蓝给定的条件下，小车位于该点的概率最大，而且，而且，它居然还是一个正态分布！正态分布就意味着，可以把它当做初值继续往下算了！这是 Kalman 滤波能够迭代的关键。

最后，把绿色分布当做第一张图中的红色分布对 t=2 时刻进行预测，算法就可以开始循环往复了。

另外，由于我只对小车位移这个一维量做了估计，因此 Kalman 增益是标量，通常情况下它都是一个矩阵。而且如果估计多维量，还应该引入协方差矩阵的迭代。

Kalman 滤波算法的本质就是利用两个正态分布的融合仍是正态分布这一特性进行迭代而已。